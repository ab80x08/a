<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Code Learner IDE</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Fira+Code&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body { 
            font-family: 'Inter', sans-serif; 
            background: #121212; 
            color: white; 
            height: 100vh; 
            display: flex; 
            flex-direction: column; 
            overflow: hidden; 
        }

        /* TOOLBAR AREA */
        .toolbar {
            background: #1a1a1a;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #333;
        }
        .logo { font-weight: bold; color: #007acc; letter-spacing: 1px; }
        .btns { display: flex; gap: 10px; }

        button {
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            transition: 0.2s;
        }
        .download-btn { background: #2ed573; color: #053318; }
        .download-btn:hover { background: #7bed9f; }
        .clear-btn { background: #ff4757; color: white; }
        .clear-btn:hover { background: #ff6b81; }

        /* EDITOR AREA */
        .editor-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            height: 45%;
            background: #1e1e1e;
        }

        .editor-box {
            position: relative;
            border-right: 1px solid #333;
            display: flex;
            flex-direction: column;
        }

        .label { 
            padding: 6px 15px; 
            font-size: 11px; 
            color: #888; 
            background: #181818; 
            text-transform: uppercase; 
            font-weight: bold;
        }

        /* Overlay textareas on top of Prism code blocks */
        .code-input, .highlight-area {
            position: absolute;
            top: 28px; left: 0;
            width: 100%; height: calc(100% - 28px);
            margin: 0; padding: 15px;
            font-family: 'Fira Code', monospace;
            font-size: 14px;
            line-height: 1.5;
            white-space: pre;
            overflow: auto;
            border: none;
        }

        .code-input {
            z-index: 1;
            background: transparent;
            color: transparent;
            caret-color: #00ff00; /* Neon green cursor */
            resize: none;
            outline: none;
        }

        .highlight-area { z-index: 0; pointer-events: none; }
        code { background: transparent !important; }

        /* PREVIEW AREA */
        .preview-container { 
            height: 55%; 
            background: white; 
            border-top: 4px solid #333;
        }
        iframe { width: 100%; height: 100%; border: none; }

        /* Responsive tweak for small screens */
        @media (max-width: 768px) {
            .editor-container { grid-template-columns: 1fr; overflow-y: auto; }
            .editor-box { height: 200px; border-bottom: 1px solid #333; }
        }
    </style>
</head>
<body>

    <div class="toolbar">
        <div class="logo">LEARN_CODE_LIVE</div>
        <div class="btns">
            <button class="download-btn" onclick="downloadProject()">üíæ Download .html</button>
            <button class="clear-btn" onclick="clearAll()">üóëÔ∏è Clear All</button>
        </div>
    </div>

    <div class="editor-container">
        <div class="editor-box">
            <div class="label">HTML Structure</div>
            <textarea id="html-in" class="code-input" spellcheck="false" oninput="update('html')" onscroll="syncScroll('html')"><h1>Hello, Coder!</h1>
<p>Change something to see the magic happen.</p>
<button id="btn">Click Me</button></textarea>
            <pre class="highlight-area"><code id="html-out" class="language-html"></code></pre>
        </div>

        <div class="editor-box">
            <div class="label">CSS Styles</div>
            <textarea id="css-in" class="code-input" spellcheck="false" oninput="update('css')" onscroll="syncScroll('css')">body { 
  font-family: sans-serif; 
  display: flex; 
  flex-direction: column;
  align-items: center; 
  justify-content: center;
  height: 80vh;
}

h1 { color: #007acc; }

#btn {
  padding: 10px 20px;
  background: #007acc;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}</textarea>
            <pre class="highlight-area"><code id="css-out" class="language-css"></code></pre>
        </div>

        <div class="editor-box">
            <div class="label">JavaScript Logic</div>
            <textarea id="js-in" class="code-input" spellcheck="false" oninput="update('js')" onscroll="syncScroll('js')">const btn = document.getElementById('btn');

btn.addEventListener('click', () => {
  alert('You just built a working web app! üöÄ');
});</textarea>
            <pre class="highlight-area"><code id="js-out" class="language-js"></code></pre>
        </div>
    </div>

    <div class="preview-container">
        <iframe id="preview"></iframe>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js"></script>

    <script>
        // Synchronize scrolling between textarea and highlight pre tag
        function syncScroll(lang) {
            let input = document.getElementById(lang + '-in');
            let output = document.getElementById(lang + '-out').parentElement;
            output.scrollTop = input.scrollTop;
            output.scrollLeft = input.scrollLeft;
        }

        // Update the visual highlight and the live preview
        function update(lang) {
            let input = document.getElementById(lang + '-in');
            let output = document.getElementById(lang + '-out');
            
            let code = input.value;
            if(code[code.length-1] == "\n") { code += " "; }
            
            output.textContent = code;
            Prism.highlightElement(output);
            renderPreview();
        }

        // Put it all together in the Iframe
        function renderPreview() {
            const html = document.getElementById("html-in").value;
            const css = "<style>" + document.getElementById("css-in").value + "</style>";
            const js = "<script>" + document.getElementById("js-in").value + "<\/script>";
            
            const display = document.getElementById("preview").contentWindow.document;
            display.open();
            display.write(html + css + js);
            display.close();
        }

        function clearAll() {
            if (confirm("Are you sure you want to clear your code? This cannot be undone!")) {
                document.getElementById('html-in').value = "";
                document.getElementById('css-in').value = "";
                document.getElementById('js-in').value = "";
                update('html'); update('css'); update('js');
            }
        }

        function downloadProject() {
            const html = document.getElementById("html-in").value;
            const css = "<style>" + document.getElementById("css-in").value + "</style>";
            const js = "<script>" + document.getElementById("js-in").value + "<\/script>";

            const fullCode = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Code Project</title>
    ${css}
</head>
<body>
    ${html}
    ${js}
</body>
</html>`;

            const blob = new Blob([fullCode], { type: "text/html" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "index.html";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize on page load
        update('html'); update('css'); update('js');
    </script>
</body>
</html>
