<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frame Rate (FPS) Comparison</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind for Inter font -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'primary-blue': '#1e40af',
                        'secondary-gray': '#f3f4f6',
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom CSS for the visualizer canvas */
        #visualizerCanvas {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border: 2px solid #3b82f6;
            background-color: #ffffff;
            touch-action: none; /* Prevents unwanted scrolling on touch devices */
        }
        .fps-button {
            transition: all 0.15s ease-in-out;
        }
        .fps-button.active {
            box-shadow: 0 0 0 3px #bfdbfe; /* Tailwind blue-200 ring effect */
            background-color: #1e40af;
            color: white;
            transform: translateY(-2px);
        }
        .fps-button:hover:not(.active) {
            background-color: #60a5fa;
            color: white;
        }
        .info-card {
            background-color: #f0f9ff; /* Tailwind sky-50 */
            border-left: 4px solid #0ea5e9; /* Tailwind sky-500 */
        }
    </style>
</head>
<body class="bg-gray-50 font-sans min-h-screen flex items-center justify-center p-4">

    <div class="w-full max-w-4xl bg-white rounded-xl shadow-2xl p-6 md:p-10">

        <h1 class="text-4xl font-extrabold text-primary-blue mb-4 text-center">
            Frame Rate (FPS) Visual Comparison
        </h1>
        <p class="text-gray-600 mb-8 text-center">
            See the difference in motion smoothness by limiting the object's drawing rate.
        </p>

        <!-- Control Panel -->
        <div class="mb-8 p-4 bg-secondary-gray rounded-lg shadow-inner">
            <h2 class="text-xl font-semibold text-gray-800 mb-3">Select Target FPS:</h2>
            <div id="fpsControls" class="grid grid-cols-4 sm:grid-cols-7 gap-3">
                <!-- Buttons will be injected here -->
            </div>
            <div class="mt-4 text-sm text-center font-medium">
                <span class="text-gray-700">Actual FPS: </span>
                <span id="actualFpsDisplay" class="font-bold text-green-600">--</span>
                <span class="ml-4 text-gray-700">Target FPS: </span>
                <span id="targetFpsDisplay" class="font-bold text-primary-blue">--</span>
            </div>
        </div>

        <!-- Canvas Area -->
        <div class="relative w-full aspect-video rounded-xl overflow-hidden">
            <canvas id="visualizerCanvas" class="w-full h-full" width="800" height="450"></canvas>
        </div>

        <!-- Description -->
        <div class="mt-10 info-card p-4 rounded-lg">
            <h3 class="text-lg font-bold text-sky-700 mb-2">What is FPS?</h3>
            <p class="text-gray-700 text-sm">
                FPS (Frames Per Second) is the frequency (rate) at which consecutive images (frames) appear on a display. The higher the FPS, the smoother and more continuous the motion appears.
                <ul class="mt-2 text-xs list-disc pl-5">
                    <li><span class="font-semibold">~10-25 FPS:</span> Very choppy, often seen in older or heavily compressed video.</li>
                    <li><span class="font-semibold">30 FPS:</span> Standard for older console games and most broadcast video.</li>
                    <li><span class="font-semibold">60 FPS:</span> Considered the minimum for smooth gaming and the standard for most modern applications.</li>
                    <li><span class="font-semibold">120+ FPS:</span> Provides extremely fluid motion, essential for competitive gaming, and requires a high refresh rate monitor.</li>
                </ul>
            </p>
        </div>

    </div>

    <script>
        // Global variables for the canvas and animation
        let canvas, ctx;
        let animationFrameId;

        // FPS Control variables
        const fpsRates = [10, 25, 30, 60, 75, 120, 240];
        let targetFps = 60; // Default target
        let interval = 1000 / targetFps; // ms per frame
        let lastTime = 0;

        // FPS Tracking for display
        let frameCount = 0;
        let fpsTimer = 0;
        let actualFps = 0;

        // Animation Object (Ball) properties
        const ball = {
            x: 50,
            y: 50,
            radius: 15,
            vx: 0.15, // Velocity in pixels per millisecond
            vy: 0.12,
            color: '#ef4444' // Tailwind red-500
        };

        // DOM elements
        const fpsControls = document.getElementById('fpsControls');
        const actualFpsDisplay = document.getElementById('actualFpsDisplay');
        const targetFpsDisplay = document.getElementById('targetFpsDisplay');

        // Utility to convert base64 audio data to WAV format (for future TTS use, not used here)
        // const base64ToArrayBuffer = (base64) => { ... };
        // const pcmToWav = (pcmData, sampleRate) => { ... };

        // 1. Setup function - runs once on load
        function init() {
            canvas = document.getElementById('visualizerCanvas');
            ctx = canvas.getContext('2d');

            // Set up the responsive canvas size
            function resizeCanvas() {
                const rect = canvas.parentElement.getBoundingClientRect();
                // Set the internal canvas resolution to match the container size
                canvas.width = rect.width;
                canvas.height = rect.height;
                // Reset ball position if canvas resizes significantly
                if (ball.x > canvas.width || ball.y > canvas.height) {
                    ball.x = canvas.width / 2;
                    ball.y = canvas.height / 2;
                }
            }
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);

            createFpsButtons();
            setTargetFps(targetFps); // Initialize displays and interval

            // Start the animation loop
            startAnimation();
        }

        // 2. Control function to change the target FPS
        function setTargetFps(newFps) {
            targetFps = newFps;
            interval = 1000 / targetFps;

            // Update UI elements
            targetFpsDisplay.textContent = `${targetFps} FPS`;

            // Update button styles
            document.querySelectorAll('.fps-button').forEach(btn => {
                btn.classList.remove('active');
                if (parseInt(btn.dataset.fps) === newFps) {
                    btn.classList.add('active');
                }
            });

            console.log(`Target FPS set to: ${targetFps}`);
        }

        // 3. Create interactive buttons
        function createFpsButtons() {
            fpsRates.forEach(fps => {
                const button = document.createElement('button');
                button.textContent = `${fps} FPS`;
                button.dataset.fps = fps;
                button.className = 'fps-button px-3 py-2 rounded-lg font-semibold text-sm bg-blue-100 text-primary-blue shadow-md hover:shadow-lg focus:outline-none focus:ring-4 focus:ring-blue-300';
                button.addEventListener('click', () => setTargetFps(fps));
                fpsControls.appendChild(button);
            });
        }

        // 4. Drawing function
        function draw() {
            // Clear the canvas
            ctx.fillStyle = '#ffffff'; // White background
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw the ball
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.fillStyle = ball.color;
            ctx.fill();
            ctx.closePath();
        }

        // 5. Update game state (movement logic)
        function update(deltaTime) {
            // Update position based on velocity and elapsed time
            ball.x += ball.vx * deltaTime;
            ball.y += ball.vy * deltaTime;

            // Bounce off edges (X-axis)
            if (ball.x + ball.radius > canvas.width || ball.x - ball.radius < 0) {
                ball.vx *= -1;
                // Correct position to prevent sticking
                if (ball.x - ball.radius < 0) ball.x = ball.radius;
                if (ball.x + ball.radius > canvas.width) ball.x = canvas.width - ball.radius;
            }

            // Bounce off edges (Y-axis)
            if (ball.y + ball.radius > canvas.height || ball.y - ball.radius < 0) {
                ball.vy *= -1;
                // Correct position to prevent sticking
                if (ball.y - ball.radius < 0) ball.y = ball.radius;
                if (ball.y + ball.radius > canvas.height) ball.y = canvas.height - ball.radius;
            }
        }

        // 6. Main animation loop with FPS limiting
        function animate(currentTime) {
            animationFrameId = requestAnimationFrame(animate);

            // Calculate time elapsed since last frame update
            const deltaTime = currentTime - lastTime;

            // FPS Limiting Logic: Only proceed if enough time has passed
            if (deltaTime >= interval) {
                // Update the state (movement)
                update(deltaTime);

                // Draw the new state
                draw();

                // Set lastTime for the next frame calculation
                lastTime = currentTime - (deltaTime % interval);

                // --- Actual FPS Calculation for display ---
                frameCount++;
                fpsTimer += deltaTime;

                if (fpsTimer >= 1000) { // If a second has passed
                    actualFps = frameCount;
                    actualFpsDisplay.textContent = `${actualFps}`;

                    // Reset counters
                    frameCount = 0;
                    fpsTimer = 0;
                }
                // The actual FPS will naturally be capped by the interval check and the browser's refresh rate.
                // When targetFps is high (like 240), the actual FPS will likely cap at the monitor's refresh rate (e.g., 60Hz or 144Hz).
            }
        }

        // 7. Control the animation loop
        function startAnimation() {
            if (animationFrameId) {
                cancelAnimationFrame(animationFrameId);
            }
            lastTime = performance.now(); // Reset timer on start
            animate(lastTime);
        }

        // Initialize the app when the window loads
        window.onload = init;

        // Welcome Notes

    </script>
    <h7>@MD Rishad Saruar</h7>
</body>
</html>
